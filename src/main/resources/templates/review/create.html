<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{ layout/basic-layout }">


<div layout:fragment="content">

<style>
	textarea:focus {
		outline: none;
	}
	
	button {
		width: 100px;
		height: 35px;
	}
	
	.star {
		position: relative;
		font-size: 32px;
		color: #ddd;
	}
	
	.star input {
		width: 100%;
		height: 100%;
		position: absolute;
		left: 0;
		opacity: 0;
		display: inline-block;
	}
	
	.star span {
		width: 0;
		position: absolute;
		left: 0;
		color: yellow;
		overflow: hidden;
		pointer-events: none;
	}
</style>
	
	<div style="width:100%; text-align:center;"><!-- main content -->
	<h1>review create page</h1>
		<div>
			<form id="formCreate">
				<span class="star">
					★★★★★
					<span>★★★★★</span>
					<input id="score" name="score" type="range" oninput="drawStar(this)" value="1" step="1" min="0" max="5"/>
				</span>
				<input id="author" name="author" type="hidden" th:value="${ #authentication.name }" />
				<div style="width:70%; border-bottom: thin solid silver; margin: auto;">
					<textarea id="title" name="title" style="width: 100%; border: none; font-size: 30px; height: 30px; resize: none;" placeholder="제목을 입력하세요" required></textarea>
				</div>
				<div style="width:70%; margin: auto;">
					<textarea id="content" name="content" style="width: 100%; height:500px; font-size: 18px; border: none; resize: none; margin-top: 15px;" placeholder="내용을 입력하세요(img)" required></textarea>
				</div>
				
				<input type="file"/>
				
				<div style="width: 70%; margin: auto; text-align: left;">
					<span style="font-size: small; color:gray;"># tag</span>
					<span style="font-size: small; color:gray;"># tag</span>
				</div>
				<input id="storage" name="storage" type="hidden" value="1"/>
			</form>
			<div style="width:70%; margin: auto; text-align: right;">
				<button id="btnSave">저장</button>
				<button id="btnRelease">발행</button>
			</div>
		</div>
		
	</div><!-- main content end -->
</div><!-- fragment end -->

<th:block layout:fragment="script">
	<script>
	const formCreate = document.querySelector('#formCreate');
	const btnSave = document.querySelector('#btnSave');
	
	btnSave.addEventListener('click', function () {
		
		document.querySelector('#storage').value = 0;
		formCreate.action = '/review/create';
		formCreate.method = 'post';
		formCreate.submit();
		});
		
	const btnRelease = document.querySelector('#btnRelease');
	btnRelease.addEventListener('click', function () {
		
		formCreate.action = '/review/create';
		formCreate.method = 'post';
		formCreate.submit();
	})
	</script> 
	<script>
		const drawStar = (target) => {
			document.querySelector(`.star span`).style.width = `${target.value * 20}%`;
		}
	</script>
</th:block>

</html>